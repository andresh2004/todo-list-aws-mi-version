stage('Static Test') {
    steps {
        echo 'üîç Ejecutando an√°lisis est√°tico con flake8 y bandit...'
        sh 'pip install --user flake8 bandit'
        sh 'flake8 src/ --format=html --htmldir=flake8_report || true'
        sh 'bandit -r src/ -f html -o bandit_report.html || true'
    }
    post {
        always {
            publishHTML([
                reportDir: 'flake8_report',
                reportFiles: 'index.html',
                reportName: 'Flake8 Report',
                keepAll: true,
                allowMissing: true,
                alwaysLinkToLastBuild: true
            ])
            publishHTML([
                reportDir: '.',
                reportFiles: 'bandit_report.html',
                reportName: 'Bandit Report',
                keepAll: true,
                allowMissing: true,
                alwaysLinkToLastBuild: true
            ])
        }
    }
}

